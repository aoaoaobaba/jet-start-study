# Webix Jet + Vite における CSS 設計パターン案（スコープ風ネスト構成）

## 🎯 目的
Webix Jet + Vite による SPA 開発において、各画面（View）ごとのスタイルを安全かつ保守しやすく管理するための CSS 設計パターンを整理する。

---

## ✅ 推奨する構成：View単位のスコープ風CSSネスト構成

### 概要
- 各 JetView ごとに対応する CSS ファイルを作成
- JetView のルート要素にユニークな `id` を付与
- CSS ファイルでは、その `id` を親セレクタとし、ネスト構文でスコープ的にスタイルを記述
- グローバルCSS（`app.css`）とは明確に役割を分ける

### 具体構成例
```plaintext
src/
├── styles/
│   └── app.css              ← 全体共通スタイル（色・フォント・レイアウト）
├── views/
│   └── user/
│       ├── index.js         ← JetView本体（id: "view-user"）
│       └── user.css         ← ネスト構文でスコープ化
```

### user.css（ネスト構文使用）
```css
#view-user {
  & .title {
    font-weight: bold;
    font-size: 20px;
  }

  & .button {
    background-color: #0055aa;
    color: white;
  }
}
```

---

## ✅ この構成のメリット

| 観点 | 内容 |
|------|------|
| 🧩 スコープ制御 | View単位でスタイルの影響範囲を明確に限定できる |
| 🔀 競合回避 | クラス名の重複による上書きを防止できる（他Viewと切り離される） |
| 🧹 保守性 | Viewとスタイルが1対1で対応し、メンテナンスが容易になる |
| 🚀 パフォーマンス | Viteが最終的に全CSSを1つにバンドルし、最適化される（重複除去も含む） |
| 🧪 HMR対応 | Viewごとの変更が即時ホットリロードされ、開発体験が高い |

---

## ⚠️ この構成を採らないと起きやすい問題

### ❌ グローバルクラスの競合
```css
/* よくある例 */
.button {
  padding: 1rem;
  color: red;
}
```
→ 複数のViewで `.button` を使っていると、**どのスタイルが適用されるか不明確**（上書きの順序依存）

### ❌ 保守性の低下
- Viewに関係ないCSSが紛れ込みやすい
- クラス名の責任範囲が曖昧になる
- 複数人開発時にスタイルの衝突が頻発する

---

## 💡 命名規則の例（BEM風の拡張）

| 要素 | 命名例 |
|------|--------|
| View ID | `#view-settings` |
| ボタン | `.settings__submit-button` |
| セクションタイトル | `.settings__title` |

→ **View名をプレフィックスに含めることで、CSSファイル単体でも責任範囲が明確**になります。

---

## 🛠 補足：CSSネストのサポート状況
- 主要モダンブラウザはすでに CSS ネストに対応済み（Chrome 112+, Safari 16.5+, Firefox 117+）
- PostCSSやViteの標準構成でも対応可能
- 追加のプリプロセッサ不要で、可読性・保守性を大きく向上できる

---

## ✅ まとめ
このCSS設計パターンは、
- Webix Jet に自然にフィットし、
- グローバルなクラス競合を回避し、
- 保守性と開発体験を両立できる現実解 です。

今後の開発・設計時にこのパターンをベースとして共有・導入することを推奨します。

このパターンを導入しておくことで、後に`@scope` に移行することも可能になります。

## CSS @scope の概要と現実的な移行パターン

### 🎯 目的
CSS の新機能 `@scope` の概要を理解し、現在の開発で採用可能なネスト構文＋IDベースの設計から将来的にスムーズに移行できる記述方法を整理する。

---

### ✅ @scope とは？

`@scope` は、CSSの新しい構文で「**ある要素をルートとし、その中でのみ適用されるスタイルを定義する**」ことができるネイティブなスコープ機能です。

#### 📌 基本構文
```css
@scope (#view-settings) {
  .button {
    background: red;
  }
}
```
→ 上記は `#view-settings` の中にある `.button` にだけ適用され、他には影響しません。

---

### ✅ なぜ @scope が注目されているのか？

| 従来の課題 | @scope で解決できること |
|-------------|---------------------------|
| グローバルなクラス名競合 | ✅ スコープ内に制限され、他Viewと干渉しない |
| クラス名のプレフィックス設計が必要 | ✅ `.button` のような汎用名でも安全に使える |
| Shadow DOM や CSS Modules 必須だった | ✅ 純粋なCSSだけでスコープが実現可能 |

---

### ✅ ブラウザ対応状況（2024年時点）

| ブラウザ | 対応状況 |
|----------|----------|
| Chrome | ✅（v120+）
| Safari | ✅（v17+）
| Edge   | ✅（Chromiumベース）
| Firefox | ❌（未対応）

> 現時点では**実務での全面採用には慎重さが必要**ですが、今後の標準CSSとしての採用は濃厚です。

---

### ✅ 将来の @scope に移行しやすい記述方法（現在の推奨）

現時点では `@scope` を使わず、以下のように**ViewルートID + ネスト構文**で記述することで、将来の `@scope` への置き換えが非常に容易になります。

#### 🔹 現在のCSS記述（ネスト構文）
```css
##view-settings {
  & .title {
    font-size: 20px;
    font-weight: bold;
  }
  & .button {
    background-color: #0055aa;
    color: white;
  }
}
```

#### 🔁 将来のCSS記述（@scope構文）
```css
@scope (#view-settings) {
  .title {
    font-size: 20px;
    font-weight: bold;
  }
  .button {
    background-color: #0055aa;
    color: white;
  }
}
```

→ **構造を変えずにほぼそのまま移行できる**。

---

### ✅ 実務での判断基準

| 判断軸 | 推奨選択 |
|--------|----------|
| 今すぐ全ブラウザで安定稼働させたい | ネスト＋IDスコープ構成（既存方式）
| 将来的な標準化を意識した設計をしたい | 上記構成で `@scope` を見越して設計
| 技術検証・先行導入を進めたい | `@scope` を試験導入しつつフォールバック対応を設ける

---

### ✅ まとめ
- `@scope` は CSS における「真のスコープ」を提供する新機能
- 現在は対応ブラウザが限定されているため、**ネスト＋IDルート構成が現実解**
- 将来 `@scope` に移行しやすいよう、**IDを使ったView単位のスコープを前提にCSSを設計**するのがベスト

> 今後のCSS設計において、`@scope` は「意識しておくべき未来の標準」です。今から準備しておくことで、よりクリーンで安全なスタイル管理が可能になります。

